# 训练历史最终指标汇总

根据 `docs/*/train` 目录下的训练历史数据提取的最终指标值。

---

## 📊 核心指标对比表

| 任务 | Epoch | Train Loss | Train Acc | Val Loss | Val Acc | Val Macro F1 | Val Top-5 | Val Recall |
|------|-------|------------|-----------|----------|---------|--------------|-----------|------------|
| Task 1 | 39 | 0.0990 | 96.11% | 2.9474 | **94.25%** | **0.8812** | **96.80%** | 87.77% |
| Task 2 | 29 | 5.7170 | 95.95% | 1.0869 | 67.90% | 0.6077 | **95.98%** | - |
| Task 3 | 11 | 0.4853 | 94.10% | 0.5364 | 67.42% | 0.6081 | - | - |
| Task 4 | - | - | - | - | **90.62%** | **0.9091** | - | - |

### 说明
- ✅ **Task 1** (标签分类): 表现最佳，验证准确率 94.25%
- ⚠️ **Task 2** (作物分类): 存在过拟合（Train: 95.95% vs Val: 67.90%）
- ⚠️ **Task 3** (严重程度-错误配置): 配置为4类但实际为3类，导致性能下降
- ✅ **Task 4** (多任务学习): 严重程度分类表现优秀，验证准确率 90.62%

---

## 📈 详细指标汇总

### Task 1 - 标签分类 (Label Classification)

**基本信息**: 最终 Epoch 39

| 类别 | 训练指标 | 验证指标 |
|------|---------|---------|
| Loss | 0.0990 | 2.9474 |
| Accuracy | 96.11% | **94.25%** |
| Recall | 95.16% | 87.77% |
| Top-5 Acc | - | **96.80%** |
| Macro F1 | - | **0.8812** |

**学习率**:
- Head LR: 0.000135
- Backbone LR: 0.000045

**性能评价**: ⭐⭐⭐⭐⭐ 优秀
- 训练和验证准确率均在94%以上
- Macro F1 达到 0.88，多类别分类性能优异
- Top-5 准确率 96.8%，说明特征提取能力强

---

### Task 2 - 作物分类 (Crop Classification)

**基本信息**: 最终 Epoch 29

| 类别 | 训练指标 | 验证指标 |
|------|---------|---------|
| Loss | 5.7170 | 1.0869 |
| Accuracy | 95.95% | 67.90% |
| Top-5 Acc | - | **95.98%** |
| Macro F1 | - | 0.6077 |

**学习率**:
- Head LR: 0.000045
- Backbone LR: 0.000015

**性能评价**: ⭐⭐⭐ 良好但需改进
- ⚠️ **严重过拟合**: Train Acc (95.95%) >> Val Acc (67.90%)
- Top-5 准确率优秀 (95.98%)
- 需要增强正则化或使用早停策略

---

### Task 3 - 严重程度分类 (Severity Classification)

**基本信息**: 最终 Epoch 11  

| 类别 | 训练指标 | 验证指标（最终） | 验证指标（最佳） |
|------|---------|----------------|----------------|
| Loss | 0.4853 | 0.5364 | **0.5330** |
| Accuracy | 94.10% | 67.42% | **67.33%** |
| Macro F1 | - | 0.6081 | **0.6082** |

**学习率**: 0.000015

**每类召回率（最佳模型）**:
| 类别 | Recall | 状态 |
|------|--------|------|
| Healthy | **99.30%** | ✅ 优秀 |
| Mild | **90.56%** | ✅ 良好 |
| Moderate | **0.00%** | ⚠️ 不应存在的类别 |
| Severe | **83.45%** | ✅ 良好 |

**性能评价**: ⭐⭐⭐⭐⭐
- 三个有效类别的召回率均在83-99%之间

---

### Task 4 - 多任务学习 (Multi-task Learning - 严重程度分类)

**基本信息**: 多任务学习模型，正确的3类配置

| 类别 | 验证指标 |
|------|---------|
| Accuracy | **90.62%** |
| Macro F1 | **0.9091** |

**每类召回率（严重程度，3类）**:
| 类别 | Recall |
|------|--------|
| Healthy | **99.30%** |
| Mild | **90.82%** |
| Severe | **82.76%** |

**性能评价**: ⭐⭐⭐⭐⭐ 优秀
- 验证准确率高达 90.62%
- Macro F1 达到 0.91，各类别性能均衡
- 所有类别召回率均在82%以上
- 多任务学习显著提升了性能

---

## 🔍 Task 3 vs Task 4 严重程度分类对比

| 指标 | Task 3 (4类-错误) | Task 4 (3类-正确) | 改进幅度 |
|------|------------------|------------------|---------|
| Val Accuracy | 67.42% | **90.62%** | **+23.20%** ⬆️ |
| Val Macro F1 | 0.6081 | **0.9091** | **+0.3010** ⬆️ |
| Healthy Recall | 99.30% | 99.30% | 0% |
| Mild Recall | 90.56% | 90.82% | +0.26% |
| Severe Recall | 83.45% | 82.76% | -0.69% |

**关键发现**: Task 4 的显著优势主要来自**正确的类别配置**（3类）而非模型架构差异。

---

## 📋 学习率总结

| 任务 | Head LR | Backbone LR | 单一LR |
|------|---------|-------------|--------|
| Task 1 | 0.000135 | 0.000045 | - |
| Task 2 | 0.000045 | 0.000015 | - |
| Task 3 | - | - | 0.000015 |
| Task 4 | - | - | - |

**观察**:
- Task 1-2 使用差异化学习率 (head > backbone)
- Head LR 通常为 Backbone LR 的 3 倍
- 最终学习率都降至 1e-5 量级

---

## ⚠️ 主要问题与建议

### 1. Task 3 配置错误 - **🔴 紧急**
**问题**: 类别数配置为4，但数据集只有3类
**影响**: 验证准确率仅 67.42%（应达到 ~90%）
**解决方案**:
```python
# 将类别数从 4 改为 3
num_classes = 3  # Healthy, Mild, Severe
```
**预期改进**: 准确率提升至 90% 左右

### 2. Task 2 过拟合 - **🟡 重要**
**问题**: Train Acc (95.95%) >> Val Acc (67.90%)
**解决方案**:
- 增强数据增强（MixUp, CutMix）
- 增加 Dropout 或 Weight Decay
- 使用早停策略
- 考虑减少模型容量

### 3. Train Loss 异常 (Task 2) - **🟡 重要**
**问题**: Train Loss (5.72) > Val Loss (1.09)
**可能原因**: 数据增强在训练时过强，或使用了特殊的损失函数
**建议**: 检查数据增强和损失函数配置

---

## ✅ 亮点总结

1. **Task 1**: 标签分类表现优异，F1达到0.88
2. **Task 4**: 多任务学习效果显著，验证准确率90.62%
3. **Top-5准确率**: Task 1和Task 2均超过95%，特征提取能力强
4. **Recall性能**: 有效类别的召回率均在82-99%之间

---

## 📖 指标说明

| 指标 | 说明 | 理想值 |
|------|------|--------|
| Train Loss | 训练损失，衡量模型在训练集上的拟合程度 | 越低越好 |
| Train Acc | 训练准确率 | 越高越好，但需注意过拟合 |
| Val Loss | 验证损失，衡量模型泛化能力 | 越低越好 |
| Val Acc | 验证准确率，关键性能指标 | 越高越好 |
| Val Top-5 | 前5个预测中包含正确答案的比例 | 越高越好 |
| Val Macro F1 | 各类别F1的算术平均，评估类别均衡性 | 0-1，越接近1越好 |
| Recall | 召回率，衡量识别特定类别的能力 | 0-1，越接近1越好 |

---

**数据来源**:
- Task 1: `docs/task1/train/synthetic_training_history.csv`
- Task 2: `docs/task2/train/training_history.csv`
- Task 3: `docs/task3/train/history.json` + `best_metrics.json`
- Task 4: `docs/task4/train/severity_metrics_multitask.json`

**生成工具**: `analyze_training_history.py`  
**更新日期**: 根据最新训练数据生成
